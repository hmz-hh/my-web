#!/bin/bash
set -e

# Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù (Ø¨Ø¯Ù„Ùˆ Ø¨Ø§Ù„Ø±Ø§Ø¨Ø· Ø¯ÙŠØ§Ù„Ùƒ)
BOT_URL="https://example.com/bot"   

# Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
BOT_PATH="/usr/bin/bot"
SERVICE_FILE="/etc/systemd/system/bot.service"

echo "â¬‡ï¸ ÙƒÙŠØ­Ù…Ù‘Ù„ Ø§Ù„Ø¨ÙˆØª Ù…Ù† $BOT_URL ..."
curl -L -o $BOT_PATH $BOT_URL

# ØªØ£ÙƒØ¯ ÙŠÙƒÙˆÙ† Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ´ØºÙŠÙ„
chmod +x $BOT_PATH

echo "ðŸ”„ ØµØ§ÙŠØ¨ Ø§Ù„Ø®Ø¯Ù…Ø© systemd Ù„Ù„Ø¨ÙˆØª ..."

cat > $SERVICE_FILE <<EOL
[Unit]
Description=My Telegram Bot
After=network.target

[Service]
ExecStart=/usr/bin/python3 $BOT_PATH
WorkingDirectory=/usr/bin
Restart=always
RestartSec=5
User=root

[Install]
WantedBy=multi-user.target
EOL

# Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ systemd
systemctl daemon-reload

# ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ø§Ø´ ØªØ¨Ø¯Ø§ Ù…Ø¹ Ø§Ù„Ø³ÙŠØ±ÙØ±
systemctl enable bot

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø© Ø¯Ø§Ø¨Ø§
systemctl restart bot

echo "âœ… Ø§Ù„Ø¨ÙˆØª ØªØ®Ø¯Ù… 24/24 Ø¹Ø¨Ø± systemd!"
echo "ØªØ´ÙˆÙ Ø§Ù„Ø­Ø§Ù„Ø© Ø¯ÙŠØ§Ù„Ùˆ Ø¨Ù‡Ø§Ø¯ Ø§Ù„Ø£Ù…Ø±: systemctl status bot"
