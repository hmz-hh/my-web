#!/bin/bash
set -e

sudo apt update && sudo apt upgrade -y
sudo apt install -y python3 python3-pip python3-venv git curl
pip3 install python-telegram-bot==20.3

# ====== Ø±ÙˆØ§Ø¨Ø· ======
BOT_URL="https://example.com/bot"          # ðŸ”´ Ø¨Ø¯Ù‘Ù„ Ø¨Ø§Ù„Ø±Ø§Ø¨Ø· Ø¯ÙŠØ§Ù„ Ø§Ù„Ø¨ÙˆØª
SCRIPT_URL="https://example.com/addssh.sh" # ðŸ”´ Ø¨Ø¯Ù‘Ù„ Ø¨Ø§Ù„Ø±Ø§Ø¨Ø· Ø¯ÙŠØ§Ù„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø«Ø§Ù†ÙŠ

# ====== Ù…Ø³Ø§Ø±Ø§Øª ======
BOT_PATH="/usr/bin/bot"
SCRIPT_PATH="/root/addssh.sh"
SERVICE_FILE="/etc/systemd/system/bot.service"

echo "â¬‡ï¸ ÙƒÙŠØ­Ù…Ù‘Ù„ Ø§Ù„Ø¨ÙˆØª Ù…Ù† $BOT_URL ..."
curl -L -o $BOT_PATH $BOT_URL
chmod +x $BOT_PATH

echo "â¬‡ï¸ ÙƒÙŠØ­Ù…Ù‘Ù„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ Ù…Ù† $SCRIPT_URL ..."
curl -L -o $SCRIPT_PATH $SCRIPT_URL
chmod +x $SCRIPT_PATH

echo "ðŸ”„ ØµØ§ÙŠØ¨ Ø§Ù„Ø®Ø¯Ù…Ø© systemd Ù„Ù„Ø¨ÙˆØª ..."
cat > $SERVICE_FILE <<EOL
[Unit]
Description=My Telegram Bot
After=network.target

[Service]
ExecStart=/usr/bin/python3 $BOT_PATH
WorkingDirectory=/usr/bin
Restart=always
RestartSec=5
User=root

[Install]
WantedBy=multi-user.target
EOL

# Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ systemd
systemctl daemon-reload
systemctl enable bot
systemctl restart bot

echo "âœ… Ø§Ù„Ø¨ÙˆØª ØªØ®Ø¯Ù… 24/24 Ø¹Ø¨Ø± systemd!"
echo "ðŸ“‚ addssh.sh ØªÙ†Ø²Ù‘Ù„ ÙÙ€ /root/addssh.sh"
echo "ðŸ” ØªØ´ÙˆÙ Ø§Ù„Ø­Ø§Ù„Ø© Ø¯ÙŠØ§Ù„ Ø§Ù„Ø¨ÙˆØª: systemctl status bot"
